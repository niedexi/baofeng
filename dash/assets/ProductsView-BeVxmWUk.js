import{_ as O,r as n,h as b,n as V,i as R,c as x,a as t,w as l,b as u,E as F,j as W,o as _,d as h,k as S,l as z,s as D,m as q,F as X,p as Y,t as Z}from"./index-j6xUvDN0.js";import{a as M}from"./index-DW_MHI2K.js";const $={class:"products-container"},ee={class:"search-container"},ae={class:"pagination-container"},te={class:"search-container"},oe={class:"pagination-container"},d=50,le={__name:"ProductsView",setup(ne){const C=n("single"),w=n(!1),y=n(!1),P=n([]),g=n([]),i=n(1),p=n(1),m=n(""),v=n(""),L=b(()=>{if(!m.value)return P.value;const a=m.value.toLowerCase();return P.value.filter(e=>{var r,s;return((r=e.productCode)==null?void 0:r.toLowerCase().includes(a))||((s=e.name)==null?void 0:s.toLowerCase().includes(a))})}),N=b(()=>{const a=(i.value-1)*d,e=a+d;return L.value.slice(a,e)}),Q=async()=>{w.value=!0;try{const a=await M.get("https://baofengagro.com/api-product/item");P.value=a.data.map(e=>({name:e.name,productCode:e.productCode}))}catch(a){F.error("获取产品数据失败"),console.error("Error fetching products:",a)}finally{w.value=!1}},j=a=>{i.value=a};V(m,()=>{i.value=1});const k=b(()=>{if(!v.value)return g.value;const a=v.value.toLowerCase();return g.value.filter(e=>{var r,s,c;return((r=e.productCode)==null?void 0:r.toLowerCase().includes(a))||((s=e.name)==null?void 0:s.toLowerCase().includes(a))||((c=e.item)==null?void 0:c.some(f=>f.toLowerCase().includes(a)))})}),I=b(()=>{const a=(p.value-1)*d,e=a+d;return k.value.slice(a,e)}),T=async()=>{y.value=!0;try{const a=await M.get("https://baofengagro.com/api-product/bundle");g.value=a.data.map(e=>({name:e.name,productCode:e.productCode,item:e.item}))}catch(a){F.error("获取组合产品数据失败"),console.error("Error fetching combo products:",a)}finally{y.value=!1}},A=a=>{p.value=a};return V(v,()=>{p.value=1}),V(C,a=>{a==="combo"&&g.value.length===0&&T()}),R(()=>{Q()}),(a,e)=>{const r=u("el-icon"),s=u("el-input"),c=u("el-table-column"),f=u("el-table"),E=u("el-pagination"),U=u("el-tab-pane"),G=u("el-tabs"),H=u("el-card"),B=W("loading");return _(),x("div",$,[t(H,null,{default:l(()=>[t(G,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=o=>C.value=o)},{default:l(()=>[t(U,{label:"单品",name:"single"},{default:l(()=>[h("div",ee,[t(s,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),placeholder:"搜索单品",clearable:"",style:{width:"300px"}},{prefix:l(()=>[t(r,null,{default:l(()=>[t(z(D))]),_:1})]),_:1},8,["modelValue"])]),S((_(),q(f,{data:N.value,style:{width:"100%"},border:""},{default:l(()=>[t(c,{prop:"productCode",label:"编码",width:"100"}),t(c,{prop:"name",label:"名称"})]),_:1},8,["data"])),[[B,w.value]]),h("div",ae,[t(E,{"current-page":i.value,"onUpdate:currentPage":e[1]||(e[1]=o=>i.value=o),"page-size":d,total:L.value.length,background:"",layout:"total, prev, pager, next",onCurrentChange:j},null,8,["current-page","total"])])]),_:1}),t(U,{label:"组合",name:"combo"},{default:l(()=>[h("div",te,[t(s,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),placeholder:"搜索组合",clearable:"",style:{width:"300px"}},{prefix:l(()=>[t(r,null,{default:l(()=>[t(z(D))]),_:1})]),_:1},8,["modelValue"])]),S((_(),q(f,{data:I.value,style:{width:"100%"},border:""},{default:l(()=>[t(c,{prop:"productCode",label:"编码",width:"100"}),t(c,{prop:"name",label:"名称"}),t(c,{label:"包含项目",width:"350"},{default:l(({row:o})=>[(_(!0),x(X,null,Y(o.item,(J,K)=>(_(),x("div",{key:K},Z(J),1))),128))]),_:1})]),_:1},8,["data"])),[[B,y.value]]),h("div",oe,[t(E,{"current-page":p.value,"onUpdate:currentPage":e[3]||(e[3]=o=>p.value=o),"page-size":d,total:k.value.length,background:"",layout:"total, prev, pager, next",onCurrentChange:A},null,8,["current-page","total"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}},ce=O(le,[["__scopeId","data-v-14f06ac5"]]);export{ce as default};
